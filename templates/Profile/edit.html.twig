{% extends 'base.html.twig' %}

{# Titre de l’onglet / page #}
{% block title %}Mon profil{% endblock %}

{# Inclusion d’un CSS spécifique à cette page #}
{% block stylesheets %}
    <link rel="stylesheet" href="{{ asset('css/edit.css') }}">
{% endblock %}

{% block body %}
    <div class="profile-page">
        <h1 class="profile-title">Mon profil</h1>

        {# 1) Affichage des messages flash "success"
           -> ajoutés côté contrôleur après un enregistrement réussi (ex: addFlash('success', '...')) #}
        {% for message in app.flashes('success') %}
            <div class="profile-success">{{ message }}</div>
        {% endfor %}

        <div class="profile-grid">

            {# 2) Zone photo (itération 1 : pas de gestion de photo, donc placeholder) #}
            <div class="profile-photo">
                <div class="photo-box">Photo</div>
            </div>

            <div class="profile-form">
                {# 3) Début du formulaire Symfony (ouvre la balise <form> + token CSRF, etc.) #}
                {{ form_start(profileForm) }}

                {# 4) Champ "Campus" affiché en lecture seule
                   -> ici, on ne passe pas par le form, on lit directement l'utilisateur connecté (app.user)
                   -> disabled = non modifiable + non envoyé au submit #}
                <div class="row">
                    <label>Campus</label>
                    <input type="text" value="{{ app.user.site.nom ?? '' }}" disabled>
                </div>

                {# 5) Champs éditables : pseudo #}
                <div class="row">
                    {# label généré depuis le FormType #}
                    {{ form_label(profileForm.pseudo) }}
                    {# input généré (type, name, id, value, classes éventuelles...) #}
                    {{ form_widget(profileForm.pseudo) }}
                    {# erreurs de validation éventuelles #}
                    {{ form_errors(profileForm.pseudo) }}
                </div>

                {# 6) Prénom #}
                <div class="row">
                    {{ form_label(profileForm.prenom) }}
                    {{ form_widget(profileForm.prenom) }}
                    {{ form_errors(profileForm.prenom) }}
                </div>

                {# 7) Nom #}
                <div class="row">
                    {{ form_label(profileForm.nom) }}
                    {{ form_widget(profileForm.nom) }}
                    {{ form_errors(profileForm.nom) }}
                </div>

                {# 8) Téléphone #}
                <div class="row">
                    {{ form_label(profileForm.telephone) }}
                    {{ form_widget(profileForm.telephone) }}
                    {{ form_errors(profileForm.telephone) }}
                </div>

                {# 9) Email #}
                <div class="row">
                    {{ form_label(profileForm.mail) }}
                    {{ form_widget(profileForm.mail) }}
                    {{ form_errors(profileForm.mail) }}
                </div>

                {# 10) Nouveau mot de passe
                   -> label personnalisé (au lieu de form_label)
                   -> l'id vient du champ Symfony (vars.id) pour lier correctement <label for="..."> #}
                <div class="row">
                    <label for="{{ profileForm.plainPassword.vars.id }}">Nouveau mot de passe</label>
                    {{ form_widget(profileForm.plainPassword) }}
                    {{ form_errors(profileForm.plainPassword) }}
                </div>

                {# 11) Action principale : bouton submit (déclenche l'envoi du formulaire) #}
                <div class="actions">
                    <button class="btn-save" type="submit">Enregistrer</button>
                </div>

                {# 12) Fin du formulaire (ferme </form> + champs cachés restants si besoin) #}
                {{ form_end(profileForm) }}
            </div>

        </div>
    </div>
{% endblock %}
