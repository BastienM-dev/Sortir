{% extends 'base.html.twig' %}

{% block title %}Profil - {{ participant.pseudo }}{% endblock %}

{% block body %}
    <h1>Profil de {{ participant.pseudo }}</h1>

    {# ===== Photo de profil ===== #}
    <div style="margin-bottom: 20px;">
        {% if participant.photoFilename %}
            <img src="{{ asset('uploads/profiles/' ~ participant.photoFilename) }}"
                 alt="Photo de profil"
                 style="max-width:200px; border-radius:10px;">
        {% else %}
            <img src="{{ asset('img/default-avatar.png') }}"
                 alt="Avatar par défaut"
                 style="max-width:200px; border-radius:10px; opacity:0.7;">
        {% endif %}
    </div>

    {# Seulement si c'est MON profil #}
    {% if app.user and app.user.id == participant.id %}
        <a href="{{ path('profil_edit') }}" class="btn btn-primary">Modifier mon profil</a>
    {% endif %}

    {# ===== Sécurité : seul le propriétaire du profil peut changer la photo ===== #}
    {% if app.user and app.user.id == participant.id %}
        <p style="margin-bottom: 20px;">
            <a href="{{ path('profil_photo_edit') }}">Changer ma photo</a>
        </p>
    {% endif %}

    <div>
        <p><strong>Nom :</strong> {{ participant.nom }}</p>
        <p><strong>Prénom :</strong> {{ participant.prenom }}</p>

        <p><strong>Email :</strong> {{ participant.mail }}</p>

        {% if participant.telephone %}
            <p><strong>Téléphone :</strong> {{ participant.telephone }}</p>
        {% endif %}

        <p><strong>Site :</strong> {{ participant.site.nom }}</p>

        <p>
            <strong>Statut :</strong>
            {% if participant.actif %}
                Actif
            {% else %}
                Inactif
            {% endif %}
        </p>

        {% if participant.administrateur %}
            <p><strong>Rôle :</strong> Administrateur</p>
        {% endif %}
    </div>

    <p style="margin-top: 20px;">
        <a href="{{ path('main_index') }}">Retour à l'accueil</a>
    </p>
{% endblock %}
